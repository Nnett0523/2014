<!DOCTYPE html >
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta http-equiv="Content-Language" content="en">
  <title>30May2014 Fri</title>
  <link rel="stylesheet" href="res/agenda.css" type="text/css">
  <script type="text/javascript" src="res/jquery/jquery.js">
 </script>
  <script type="text/javascript" src="res/agenda.js">
 </script>
  <script type="text/javascript" src="./res/tocBuilder.js">
 </script>
  <link href="./res/jquery/tocBuilder.css" rel="stylesheet" type="text/css">
  <script type="text/javascript">
      $(document).ready(function () {
      });
  </script>
</head>

<body>

<div id="agendaHeader">

<div class="fixedHeader">
<a href="agenda20140529.html" accesskey="-"><img alt="prev"
src="res/left.gif"></a><a href="agenda20140531.html" accesskey="+"><img
alt="next" src="res/right.gif"></a> 

<h1 style="display: inline; ">agenda 30May2014 Fri </h1>
</div>

<div id="agendaLinks">

<div id="tocContainer" class="tocContainer">

<div class="toc">
</div>
</div>

<p> </p>

<p>Ripley Tiendas Por Departamento SAS Nit 900.517.323  </p>

<p><a href="http://docstore.mik.ua/orelly/unix3/upt/index.htm">UNIX Power
Tools</a> </p>

<p><a
href="http://unix.stackexchange.com/questions/65803/why-is-printf-better-than-echo">Why
is printf better than echo?</a> </p>
<hr>
</div>
</div>

<div id="agendaBody">
<h3>sh-PE-Ripley testing</h3>

<p></p>
<ol>
  <li>El nombre del archivo donde graba los parms es <code>.parm</code> - solo
    la extensión</li>
  <li class="doneItem">El pedir la estructura muestra opciones 0 y 1 en vez de
    1 y 2. </li>
  <li>Se para con 
    <p><code>sh-PE-Ripley[536]: =201405: not found</code></p>
    <p>y hay que cancelar. </p>
  </li>
  <li>No se muestra el nombre del archivo en paramsDisplay() (muestra el "1"
    residual) </li>
  <li>Un NIT para probar: 00900047981</li>
  <li>Los NIT son de 11 o 9 dígitos: retirar el control de longitud? 
    <p>exigir 9 como mínimo</p>
  </li>
  <li>Busca SANATA incluso para proceso "A" actual y protesta por que no hay de
    los últimos meses. 
    <p>Saltear el control si ep proceso es "A". </p>
  </li>
  <li>SANATA: ¿hay instrucciones? Se exportan unas variables EXTFH y DATABASE,
    ¿tienen uso?</li>
  <li>NIT: debe asegurar que tenga 11 dígitos para usarlo en la regex de la
    extracción</li>
  <li>SCOTBATCH: parámetros de linea de comando: 
    <ol>
      <li>W-FECHA-BASE 9(6)</li>
      <li>W-TIPO-SCORE x(27) = 9(2)+9(3)+...</li>
      <li>W-TIPO-ARCHIVO x(3)</li>
      <li>W-ARCHIVO-ENT x(80)</li>
      <li>W-ARCHIVO-MANT x(20)</li>
      <li>W-NITSUS 9(11)</li>
      <li>W-FORZARINICIAR x(2)</li>
    </ol>
  </li>
  <li>SCOTBATCH: agregar output al archivo .log </li>
  <li>Probar extracción por cod subscriptor</li>
</ol>

<p></p>

<p></p>

<h3>consultas PE Ripley</h3>

<p></p>
<ol>
  <li class="doneItem">En el script ejemplo se vé cómo ejecutar un proceso de
    extracción en base a un NIT. 
    <p>Necesito un ejemplo similar para extracción por cod suscriptor. </p>
    <p>Mismo archivo, otras columnas. Ver en macros. </p>
  </li>
  <li class="doneItem">En el proceso de extracción se identifica la máquina de
    desarrollo por su IP 172.24.6.154, que no coincide con la IP de la máquina
    codes (172.16.10.17). 
    <p>¿Es correcto usar la IP ...17?</p>
    <p>Ver macro sh-score-colaborA: GetAmbiente() y GetFechaSistema()</p>
    <p>Ver cómo hace las extracciones. </p>
  </li>
  <li class="doneItem">En el proceso de extracción se cambia el directorio
    según sea una máquina de desarrollo o producción. Ninguno de los
    directorios mencionados contienen un archivo ICMCRECOPY.DAT. 
    <p>¿Cuál es el procedimiento que se debe usar?</p>
    <pre>/d/iccol/desarrollo/macros&gt;find / -name ICMCRECOPY.DAT -print 2&gt; /dev/null | &gt;
/dicsuper/ICMCRECOPY.DAT
/dicregis/pva/temporales/ICMCRECOPY.DAT
/despeciales2/produccion/temporales/ICMCRECOPY.DAT
<strong>/despeciales/ICMCRECOPY.DAT</strong>
/d/iccol/desarrollo/macros&gt;</pre>
  </li>
  <li class="doneItem">¿Cuál es el codigo de suscriptor de Ripley? Sería
    conveniente conocerlo en el shell para ofrecerlo como valor por defecto al
    operador. 
    <p>Puede haber varios por suscriptor. </p>
  </li>
  <li class="doneItem">El NIT de Ripley ¿es 900517323? </li>
  <li class="doneItem">El proceso de Falabella que uso como ejemplo ejecuta un
    programa CTL100 que cuando el archivo tiene estructura 1-11 le agrega los
    nombres y lo convierta a 1-11-45. 
    <p>¿Sigue siendo necesario ejecutar ese paso, o podemos alimentar el PESVNO
    directamente con un archivo 1-11?</p>
    <p>No se usa. </p>
  </li>
  <li class="doneItem">Por qué, en la extracción, busca por ID tipo 1 o 4, si
    dice que estrae por NIT y 1 no es NIT? 
    <p>Es el NIT del suscriptor, no el del individuo</p>
  </li>
  <li class="doneItem">En el ingreso del NIT, debo pedir 11 dígitos o 9
    dígitos? 
    <p>El script pide 11, pero talvez deben ser 9. </p>
  </li>
  <li class="doneItem">¿Cuáles opciones de scoring debo seleccionar? 
    <p>En principio voy con las mismas del script ejemplo: </p>
    <p><code>$SCO41$SCO45$SCO47$SCO48$SCO49$SCO62$SCO67$SCO95$SCO99</code></p>
    <p>aunque hay dudas: </p>
    <pre> Opciones Scoring Seleccionadas: 
        +  [41] ACIERTA A - VEHÍCULO E HIPOTECARIO 
        +  [45] ACIERTA A - COOPERATIVAS         
        +  [47] ACIERTA A - FINANCIERO           
        +  [48] ACIERTA A - TARJETA DE CRÉDITO  
        +  [49] ACIERTA A - TELECOMUNICACIONES  
        +  [95] ACIERTA A INSTALAMENTOS    
        +  [  ] rotativo 
        +  [  ] codeudores
        no       [62] QUANTO                     
        no       [67] ACIERTA+                   
        no       [99] CARACTERISTICAS </pre>
    <p>El req menciona "rotativo" y "codeudores" que no está en la lista. La
    lista tiene QUANTO, ACIERTA+ y CARACTERISTICAS que no identifico en el
    requerimiento, aunque CARACTERISTICAS creo que se incluye por defecto. </p>
    <p>La opción "STABILITY" está off en todos los casos. </p>
  </li>
  <li class="doneItem">Programa nuevo: 
    <pre>x iceprerip01-test prueba200.val prueba200.inc 2 A 20140530</pre>
    <pre>archivo de entrada, archivo de entrada de inconsistencias, estructura del archivo, tipo de proceso, fecha del periodo</pre>
  </li>
  <li class="doneItem">Cuando la base es interna el script arma el nombre del
    archivo por ejemplo "PERipley20140522" con la fecha del día. Es simple y
    fácil de recordar, pero no deja ejecutar dos procesos distintos en el mismo
    día. 
    <p>Como el proceso ejemplo dice ser semestral, no parecería haber una
    necesidad de múltiples procesos en un día. </p>
    <p>El nombre de archivo es OK. </p>
  </li>
  <li>Uso unas regex para la extracción que no sé bien lo que hacen: 
    <pre>    if [[ $TIPO_EXTRACT = "N" ]]
    then
        grepRegex="^A......[14].*"$ID_EXTRACT".P$" (el id es de 11 dígitos)
    else
        grepRegex="^A$ID_EXTRACT[14].*.P$"         (el id es de 6 dígitos)
    fi</pre>
    <p>La duda es esa "A" al comienzo del registro, y la "P" al final. </p>
    <p>No encontré un COPY con el nombre de este archivo. </p>
    <p>A: activo, P: principal, no codeudor (C)</p>
    <p>[14]: personas </p>
    <p>buscar ICMCRECOPY </p>
  </li>
  <li class="doneItem">No tengo claro el tema de SANATA y si el script debería
    hacer algo especial, aparte de setear variables de entorno. 
    <p>Aparentemente está bien con lo que hay. </p>
  </li>
  <li>Cuando la base es externa, y el nombre del archivo tiene extensión, hay
    que quitársela, caso contrario se generan archivos que no se listan con el
    ls final. </li>
</ol>

<p> </p>

<h4>Archivos de input para PESVNO</h4>

<p>El programa PESVNO puede procesar archivos con estructura 1-11 (tipo y
número de identificación o NIT) y con estructura 1-11-45 (con el agregado del
nombre). </p>

<p>Cuando la estructura del archivo es 1-11 se le antepone un registro, que
está contenido en el archivo <code>$DATOS/REGPESVNO.VALI</code> - consistente
en ese solo registro. </p>

<p>Ejemplo: Ver el comando <strong><code>sh-PE-Rentabilizacion</code></strong>
como ejemplo del uso de PESVNO. </p>

<p>Tiene 5 parámetros: </p>
<ol>
  <li>nombre del archivo de entrada</li>
  <li>nombre del archivo de salida con IDs validados</li>
  <li>nombre del archivo de salida con IDs inconsistentes</li>
  <li>"10" fijo</li>
  <li>"2" fijo. </li>
</ol>

<p>Se controla que la suma de las cantidades de registros de ambos archivos de
salida sea igual a la cantidad de registros del archivo de entrada. </p>

<p></p>

<h4>Ejecución del programa SCOTBATCH</h4>

<p>Ver el script ejemplo: <strong><code>sh-score-std-batch</code></strong></p>

<p>El programa se ejecuta en tres lugares:</p>
<ul>
  <li>línea 425: múltiples scores </li>
  <li>línea 440: igual </li>
  <li>línea 992: ejecución sencilla que calcula un solo tipo de score. </li>
</ul>

<p>Los parámetros de ejecución son así: </p>
<ol start="0">
  <li><code>nohup x SCOTBATCH</code>: inicia el programa </li>
  <li><code>$fechabase</code> La fecha de proceso en formato YYYYMM</li>
  <li><code>$SCO41$SCO45$SCO47$SCO48$SCO49$SCO62$SCO67$SCO95$SCO99</code> Los
    scores a calcular. El programa genera un archivo de salida por cada score,
    cada archivo de salida tiene el nombre del score en la extensión (ver en el
    programa). </li>
  <li><code>$formato</code>: "VAL" significa el formato de salida del archivo
    .val del PESVNO</li>
  <li><code>$cadena04</code> </li>
  <li><code>$mnto</code> </li>
  <li><code>$nitsus</code> (cero si no se sabe) </li>
  <li><code>&gt;&gt; $cadena06 2&gt;&gt; $cadena06</code> El log,
  redireccionado</li>
</ol>

<p><code>$SCO41$SCO45$SCO47$SCO48$SCO49$SCO62$SCO67$SCO95$SCO99</code></p>

<p></p>

<p></p>

<p>De: Salamanca, Ivan<br>
Enviado el: viernes, 30 de mayo de 2014 10:50 a.m.<br>
Para: sandra.gordillo@globant.com<br>
CC: molina, wilson<br>
Asunto: RE: Datos necesarios VAP-Ripley</p>

<p>Buenos días,</p>

<p>En el ambiente PVA tenemos 124.837 identificaciones que están cargadas a
Enero de 2014, adjunto envió el archivo con dichas identificaciones y la forma
de situarse en el ambiente PVA es ejecutando la macro sh-pva y para confirmar
en qué ambiente quedo la sesión, el comando amb y mostrara el directorio de PVA
de la siguiente manera:</p>
<pre>icimsd@codes /d/iccol/desarrollo/temporales
$ . sh-pva
icimsd@codes /d/iccol/desarrollo/temporales
$ amb
/dicregis/pva</pre>

<p>No es necesario utilizar vectores de cartera, ya que la información
solicitada está en el maestro ICMCRE, entonces de este pueden tomar la
información necesaria para el reporte.</p>

<p> </p>
<pre>/d/iccol/desarrollo&gt;find / -name extfh.cfg -print 2&gt; /dev/null | grep -v cann&gt;
/icven/desarrollo/database/extfh.cfg
/icven/desarrollo/extfh.cfg
/icven/icdbant/extfh.cfg
/icven/produccion/extfh.cfg
/dicdb/extfh.cfg
/despeciales2/prueba-globant/extfh.cfg
/despeciales2/produccion/datos/glbnt/base0/extfh.cfg
/despeciales2/produccion/datos/glbnt/base1/extfh.cfg
/despeciales2/produccion/icdb/extfh.cfg
/despeciales2/produccion/extfh.cfg
/despeciales2/produccion/backup/extfh.cfg
/despeciales/BBVA/extfh.cfg
/despeciales/indeptes/extfh.cfg
/d/iccol/desarrollo/database/desnovedat/extfh.cfg
/d/iccol/desarrollo/database/prunovedat/extfh.cfg
/d/iccol/desarrollo/database/extfh.cfg
/d/iccol/desarrollo/extfh.cfg</pre>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>
</div>
</body>
</html>
