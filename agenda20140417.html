<!DOCTYPE html >
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta http-equiv="Content-Language" content="en">
  <title>17Apr2014 Thu</title>
  <link rel="stylesheet" href="res/agenda.css" type="text/css">
  <script type="text/javascript" src="res/jquery/jquery.js">
 </script>
  <script type="text/javascript" src="res/agenda.js">
 </script>
  <script type="text/javascript" src="./res/tocBuilder.js">
 </script>
  <link href="./res/jquery/tocBuilder.css" rel="stylesheet" type="text/css">
  <script type="text/javascript">
      $(document).ready(function () {
      });
  </script>
</head>

<body>

<div id="agendaHeader">

<div class="fixedHeader">
<a href="agenda20140416.html" accesskey="-"><img alt="prev"
src="res/left.gif"></a><a href="agenda20140418.html" accesskey="+"><img
alt="next" src="res/right.gif"></a> 

<h1 style="display: inline; ">agenda 17Apr2014 Thu </h1>
</div>

<div id="agendaLinks">

<div id="tocContainer" class="tocContainer">

<div class="toc">
</div>
</div>

<p> </p>

<p><a
href="http://supportline.microfocus.com/Documentation/books/sx51/sx51indx.htm">MF
Server Express 5.1 reference</a>  </p>

<p><a
href="https://supportline.microfocus.com/Documentation/books/sx40sp2/spudsc.htm">MF
Fixed list dynamic SELECT statements</a> </p>

<p><a
href="http://documentation.microfocus.com/help/topic/com.microfocus.eclipse.infocenter.visualcobol.vs/BKDBDBCURS.html">MF
Cursors</a> </p>

<p><a
href="http://pic.dhe.ibm.com/infocenter/db2luw/v9r7/topic/com.ibm.db2.luw.sql.ref.doc/doc/c0004100.html">IBM
DB2 Version 9.7 for Linux, UNIX, and Windows: SQL</a> </p>
<hr>
</div>
</div>

<div id="agendaBody">
<h3>zzz</h3>

<p><a
href="http://www-01.ibm.com/support/knowledgecenter/SSEPGG_9.7.0/com.ibm.db2.luw.sql.ref.doc/doc/r0000937.html?cp=SSEPGG_9.7.0%2F5-5-6-110">DECLARE
CURSOR</a> </p>

<p><a
href="http://www-01.ibm.com/support/knowledgecenter/SSEPGG_9.7.0/com.ibm.db2.luw.sql.ref.doc/doc/r0000973.html?cp=SSEPGG_9.7.0%2F5-5-6-155">OPEN</a>
</p>

<p><a
href="http://www-01.ibm.com/support/knowledgecenter/SSEPGG_9.7.0/com.ibm.db2.luw.sql.ref.doc/doc/r0000954.html?cp=SSEPGG_9.7.0%2F5-5-6-122">FETCH</a>
</p>

<p><a
href="http://www-01.ibm.com/support/knowledgecenter/SSEPGG_9.7.0/com.ibm.db2.luw.sql.ref.doc/doc/r0000899.html?cp=SSEPGG_9.7.0%2F5-5-6-43">CLOSE</a>
</p>

<p><a
href="http://www-01.ibm.com/support/knowledgecenter/SSEPGG_9.7.0/com.ibm.db2.luw.sql.ref.doc/doc/r0000975.html?cp=SSEPGG_9.7.0%2F5-5-6-156">PREPARE</a>
</p>

<p></p>

<p></p>

<p>from MF: <a
href="https://supportline.microfocus.com/Documentation/books/sx40sp2/spudsc.htm">Chapter
3: Using Dynamic SQL in COBOL</a> </p>

<p>The following example shows how to execute a fixed-list SELECT statement
dynamically.</p>
<pre>* include SQLDA copybook 
     EXEC SQL INCLUDE SQLDA END-EXEC

* set query text 
     MOVE "select e_no, lname from employee where dept='1050'" TO sqlcmd.

* prepare SELECT command
     EXEC SQL PREPARE q1 FROM :sqlcmd END-EXEC

* declare cursor for SELECT command
     EXEC SQL DECLARE c1 CURSOR FOR q1 END-EXEC

* open cursor
     EXEC SQL OPEN c1 END-EXEC

* fetch data into program variables EMPNO, LASTNME and FIRSTNME
     EXEC SQL FETCH c1 INTO :EMPNO, :LASTNME END-EXEC 

* close cursor
     EXEC SQL CLOSE c1 END-EXEC</pre>

<p>Otro, de IBM, en C: </p>
<pre>   EXEC SQL DECLARE C1 CURSOR FOR
     SELECT DEPTNO, DEPTNAME, MGRNO FROM TDEPT
       WHERE ADMRDEPT = 'A00';

   EXEC SQL OPEN C1;

   while (SQLCODE==0) {
       EXEC SQL FETCH C1 INTO :dnum, :dname, :mnum;
   }

   EXEC SQL CLOSE C1;</pre>
<ol>
  <li>0000-PROGRAMA-PRINCIPAL.</li>
  <li>1000-ABRIR-ARCHIVOS. 
    <ol>
      <li>1001-INICIAR-BASEDEDATOS. 
        <ol>
          <li>declare vcurs cursor for dynamic_sql</li>
          <li>PERFORM 1000-BUSCA-USUPASS. 
            <ol>
              <li>MOVE "lstxclde" TO WS-USR</li>
              <li>MOVE "LstxcD8" TO WS-PASS</li>
              <li>MOVE "LIST_DL1" TO WS-ALIAS</li>
              <li>PERFORM 1000-BIND-RUTSQL. 
                <p>Bind local a la base de datos elegida</p>
              </li>
            </ol>
          </li>
          <li>1000-CONECTARSE-A-LAS-BDS. 
            <ol>
              <li>1000-CONECTAR-XXXX-DL1. 
                <ol>
                  <li>CONNECT TO :WS-ALIAS USER :WS-USR USING :WS-PASS</li>
                </ol>
              </li>
            </ol>
          </li>
        </ol>
      </li>
    </ol>
  </li>
</ol>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>
</div>
</body>
</html>
